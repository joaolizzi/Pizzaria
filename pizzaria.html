<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Roleta - Vers√£o estilo "tigrinho" (alternativa legal)</title>
<style>
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --accent:#ffb020;
    --muted:#9aa6b2;
    --glass: rgba(255,255,255,0.04);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  *{box-sizing:border-box}
  html,body{height:100%;}
  body{
    margin:0;
    background: linear-gradient(180deg,var(--bg) 0%, #071024 100%);
    color:#e6eef6;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:20px;
  }

  .app{
    width:100%;
    max-width:920px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:14px;
    padding:20px;
    box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    display:grid;
    grid-template-columns: 1fr 340px;
    gap:20px;
  }

  @media (max-width:880px){
    .app{grid-template-columns: 1fr; padding:16px;}
  }

  .game{
    padding:18px;
    background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
    border-radius:10px;
    display:flex;
    flex-direction:column;
    gap:14px;
  }

  .header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }
  .title{
    display:flex;
    gap:12px;
    align-items:center;
  }
  .logo{
    width:46px; height:46px; border-radius:10px;
    background:linear-gradient(135deg,#ffb020,#ff6b6b);
    display:flex;align-items:center;justify-content:center;font-weight:700;
    color:#051725; font-size:20px;
    box-shadow: 0 6px 14px rgba(255,176,32,0.12);
  }
  .h1{font-size:18px; margin:0;}
  .muted{color:var(--muted); font-size:13px}

  /* reels area */
  .reels-wrap{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
    padding:12px;
    background:var(--glass);
    border-radius:10px;
    min-height:220px;
  }

  .reel{
    width:110px;
    height:160px;
    overflow:hidden;
    border-radius:10px;
    background:linear-gradient(180deg,#071827, #0b2838);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.02), 0 8px 18px rgba(2,6,23,0.6);
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
    border:1px solid rgba(255,255,255,0.03);
  }

  .reel-track{
    position:absolute;
    width:100%;
    top:0;
    left:0;
  }

  .symbol{
    height:160px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:52px;
    user-select:none;
  }

  .controls{
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:space-between;
    margin-top:6px;
  }
  .bets{
    display:flex;
    gap:8px;
    align-items:center;
  }
  input[type=number]{
    width:120px;padding:8px;border-radius:8px;border:0;background:#071827;color:#dff0ff;font-weight:600;
    box-shadow: inset 0 -4px 20px rgba(0,0,0,0.6);
  }

  button{
    border:0;
    padding:12px 18px;
    border-radius:10px;
    background:var(--accent);
    color:#051725;
    font-weight:700;
    cursor:pointer;
    box-shadow: 0 8px 18px rgba(255,176,32,0.12);
  }
  button:active{transform:translateY(1px)}
  .spin-btn{
    width:100%;
    font-size:18px;
    display:block;
  }

  .panel{
    padding:16px;
    background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent);
    border-radius:10px;
  }

  .stats{
    display:flex;gap:10px;flex-direction:column;
  }
  .stat-row{display:flex;justify-content:space-between;align-items:center;padding:6px 0;}
  .big{font-size:20px;font-weight:700}
  .small{font-size:13px;color:var(--muted)}

  .result{
    margin-top:10px;
    font-weight:700;
    font-size:16px;
    min-height:24px;
    color:#cde7ff;
  }

  footer.note{font-size:12px;color:var(--muted);margin-top:8px}

  /* nice shimmer for winning reels */
  .win {
    box-shadow: 0 0 18px rgba(255,200,50,0.18), 0 6px 30px rgba(255,140,20,0.06) !important;
    transform: scale(1.03);
  }
</style>
</head>
<body>
  <div class="app" role="application" aria-label="Slot game">
    <div class="game">
      <div class="header">
        <div class="title">
          <div class="logo">RT</div>
          <div>
            <div class="h1">Roleta Alternativa</div>
            <div class="muted">Toque em SPIN ‚Äî jogo s√≥ para divers√£o</div>
          </div>
        </div>
        <div style="text-align:right">
          <div class="small">Vers√£o: demo</div>
          <div class="muted" style="font-size:12px">Sem dinheiro real</div>
        </div>
      </div>

      <div class="reels-wrap" id="reelsWrap" aria-hidden="false">
        <div class="reel" id="reel0" aria-label="Rolo 1">
          <div class="reel-track" id="track0"></div>
        </div>
        <div class="reel" id="reel1" aria-label="Rolo 2">
          <div class="reel-track" id="track1"></div>
        </div>
        <div class="reel" id="reel2" aria-label="Rolo 3">
          <div class="reel-track" id="track2"></div>
        </div>
      </div>

      <div class="controls">
        <div class="bets">
          <label class="small" for="bet">Aposta</label>
          <input id="bet" type="number" min="1" step="1" value="5" aria-label="Valor da aposta" />
          <button id="minBet">-</button>
          <button id="maxBet">+</button>
        </div>
        <div style="flex:1"></div>
        <div style="width:220px">
          <button id="spin" class="spin-btn" aria-live="polite">SPIN</button>
        </div>
      </div>

      <div class="panel">
        <div class="stats">
          <div class="stat-row"><div class="small">Saldo</div><div id="balance" class="big">100</div></div>
          <div class="stat-row"><div class="small">√öltimo ganho</div><div id="lastWin" class="big">-</div></div>
          <div class="result" id="resultText" aria-live="polite"></div>
        </div>
        <div class="note">Use o bot√£o SPIN. N√£o √© jogo de azar real ‚Äî apenas divers√£o.</div>
      </div>
    </div>

    <div class="panel" aria-label="Informa√ß√µes">
      <h3 style="margin-top:0">Regras & Pagamentos</h3>
      <ul style="padding-left:18px;margin:6px 0;color:var(--muted)">
        <li>3 iguais ‚Äî paga 10√ó a aposta</li>
        <li>2 iguais ‚Äî paga 2√ó a aposta</li>
        <li>√çcones √∫nicos e imagin√°rios ‚Äî jogo criado para aprendizado e divers√£o</li>
      </ul>
      <div style="margin-top:12px">
        <strong>√çcones:</strong>
        <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
          <!-- legenda dos s√≠mbolos -->
          <div style="display:flex;gap:8px;align-items:center;"><span style="font-size:26px">üçä</span><small class="muted">Laranja</small></div>
          <div style="display:flex;gap:8px;align-items:center;"><span style="font-size:26px">üçã</span><small class="muted">Lim√£o</small></div>
          <div style="display:flex;gap:8px;align-items:center;"><span style="font-size:26px">üçí</span><small class="muted">Cereja</small></div>
          <div style="display:flex;gap:8px;align-items:center;"><span style="font-size:26px">‚≠ê</span><small class="muted">Estrela</small></div>
          <div style="display:flex;gap:8px;align-items:center;"><span style="font-size:26px">üêØ</span><small class="muted">Tigre (icone original)</small></div>
          <div style="display:flex;gap:8px;align-items:center;"><span style="font-size:26px">üçá</span><small class="muted">Uva</small></div>
        </div>
      </div>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:14px 0" />
      <div style="font-size:13px;color:var(--muted)">
        Dica: toque o SPIN com o polegar para jogar no celular. C√≥digo aberto ‚Äî personalize os √≠cones e pagamentos como quiser.
      </div>
    </div>
  </div>

<script>
/*
  Slot machine demo
  - 3 reels
  - Symbols array uses emoji (can replace by inline SVGs)
  - Physics: each reel will spin with random extra rotations and stop at a symbol index
*/

const symbols = ["üçä","üçã","üçí","‚≠ê","üêØ","üçá","üçâ","üîî","üçç"]; // 9 symbols
const reels = 3;
const symbolHeight = 160; // must match .symbol height in CSS
let balanceEl = document.getElementById('balance');
let lastWinEl = document.getElementById('lastWin');
let resultText = document.getElementById('resultText');
let betInput = document.getElementById('bet');
let spinBtn = document.getElementById('spin');

let balance = 100;
let spinning = false;
let lastWin = 0;

function format(n){ return Math.round(n*100)/100; }
function updateUI(){
  balanceEl.textContent = format(balance);
  lastWinEl.textContent = lastWin>0 ? "+"+format(lastWin) : (lastWin===0? '-' : '-' + format(Math.abs(lastWin)));
}

updateUI();

// Create tracks: each track will contain symbol nodes repeated multiple times to allow smooth scroll
for(let r=0;r<reels;r++){
  const track = document.getElementById('track'+r);
  track.style.transition = 'none';
  // Fill the track with multiple cycles of symbols to allow long scroll
  for(let rep=0; rep<6; rep++){
    for(let s=0;s<symbols.length;s++){
      const el = document.createElement('div');
      el.className = 'symbol';
      el.innerText = symbols[s];
      track.appendChild(el);
    }
  }
  // Clone first symbol at end so loop looks nicer
}

// Utility to get random integer
function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min }

// Do a spin
spinBtn.addEventListener('click', async ()=>{
  if(spinning) return;
  let bet = Number(betInput.value) || 0;
  if(bet <= 0){ resultText.textContent = 'Aposta inv√°lida.'; return; }
  if(bet > balance){ resultText.textContent = 'Saldo insuficiente.'; return; }
  spinning = true;
  spinBtn.disabled = true;
  resultText.textContent = '';
  balance -= bet;
  updateUI();

  // Choose final symbol indices for each reel
  const finalIndices = [];
  for(let r=0;r<reels;r++){
    finalIndices.push(randInt(0, symbols.length-1));
  }

  // For visual fairness, make center symbol the result.
  // We'll animate each reel with different durations and easing via JS loop.
  const promises = [];
  for(let r=0;r<reels;r++){
    promises.push(spinReel(r, finalIndices[r], 2000 + r*500 + randInt(0,600)));
  }

  // Wait for all to finish
  await Promise.all(promises);

  // Determine payout
  // If all three equal
  const [a,b,c] = finalIndices;
  let win = 0;
  if(a===b && b===c){
    win = bet * 10;
    resultText.textContent = `Tr√™s ${symbols[a]}! Voc√™ ganhou ${win} moedas üéâ`;
    // visual highlight
    highlightWinningReels([0,1,2]);
  } else if(a===b || b===c || a===c){
    win = bet * 2;
    resultText.textContent = `Dois iguais! Voc√™ ganhou ${win} moedas ‚ú®`;
    // find which reels match
    const winners = [];
    if(a===b) winners.push(0,1);
    if(b===c) winners.push(1,2);
    if(a===c) winners.push(0,2);
    highlightWinningReels([...new Set(winners)]);
  } else {
    resultText.textContent = 'Que pena ‚Äî sem combina√ß√£o. Tente novamente.';
  }

  balance += win;
  lastWin = win;
  updateUI();

  // small pause for UX
  setTimeout(()=>{ spinning=false; spinBtn.disabled=false; }, 350);

});

// spinReel: animates track to land with center symbol = index
function spinReel(reelIndex, targetSymbolIndex, durationMs){
  return new Promise(resolve=>{
    const track = document.getElementById('track'+reelIndex);
    // The track currently is multiple repetitions of symbols. We'll move it vertically.
    // compute how many symbol-steps to spin: base cycles + offset to target
    // pick a large offset for a longer spin
    const cycles = randInt(6,9); // how many full cycles
    const totalSymbols = symbols.length * cycles + targetSymbolIndex;
    const finalOffset = totalSymbols * symbolHeight;

    // reset transition to none to set starting translate
    track.style.transition = 'none';

    // compute current translateY (if any)
    const currentTransform = getComputedStyle(track).transform;
    let currentY = 0;
    if(currentTransform && currentTransform !== 'none'){
      const vals = currentTransform.match(/matrix.*\((.+)\)/)[1].split(', ');
      currentY = parseFloat(vals[5]);
    }

    // set start position a little negative so movement feels centered
    // apply transform directly to allow transition
    // We'll animate from currentY to -finalOffset (negative because moving up)
    // For simplicity, set start to 0, set translateY to 0 now
    track.style.transform = `translateY(${currentY}px)`;

    // Force reflow to ensure styles applied
    track.getBoundingClientRect();

    // Apply transition for duration with cubic-bezier easing (nice ease-out)
    track.style.transition = `transform ${durationMs}ms cubic-bezier(0.16, 0.84, 0.26, 1)`;
    track.style.transform = `translateY(${-finalOffset}px)`;

    // After transition ends, snap the DOM so we don't accumulate huge offsets
    const cleanup = ()=>{
      // remove listener
      track.removeEventListener('transitionend', cleanup);
      // compute which symbol is at top after finalOffset: modulo symbols.length
      // We'll set transform to a small value showing the chosen symbol centered:
      const offsetSymbols = totalSymbols % symbols.length;
      // rebuild track to a neutral state: set transform to negative (offsetSymbols * symbolHeight)
      // To avoid jank, temporarily disable transition
      track.style.transition = 'none';
      // Build a new shorter track that ensures target symbol is at the first visible position
      // Clear nodes and add a few symbols around the target for visual continuity
      track.innerHTML = '';
      // add 4 symbols above, target, and 4 below (wrap using modulo)
      const context = 4;
      for(let i=-context; i<=context; i++){
        const idx = mod(targetSymbolIndex + i, symbols.length);
        const el = document.createElement('div');
        el.className = 'symbol';
        el.innerText = symbols[idx];
        track.appendChild(el);
      }
      // position so that the middle symbol (context index) is visible
      const newOffset = -context * symbolHeight;
      track.style.transform = `translateY(${newOffset}px)`;
      // small timeout to re-enable interactions
      setTimeout(()=>resolve(),50);
    };

    // Listen for transition end
    track.addEventListener('transitionend', cleanup);
  });
}

function mod(n,m){ return ((n % m) + m) % m; }

// highlight reels indexes (array)
function highlightWinningReels(indexes){
  // add class to reel elements for a moment
  indexes.forEach(i=>{
    const el = document.getElementById('reel'+i);
    el.classList.add('win');
    setTimeout(()=>el.classList.remove('win'), 1400);
  });
}

/* small helpers for bet buttons */
document.getElementById('minBet').addEventListener('click', ()=>{
  let v = Number(betInput.value)||1;
  v = Math.max(1, Math.floor(v/2));
  betInput.value = v;
});
document.getElementById('maxBet').addEventListener('click', ()=>{
  let v = Number(betInput.value)||1;
  v = Math.min(9999, Math.floor(v*2));
  betInput.value = v;
});

// Accessibility: allow Enter to spin
betInput.addEventListener('keydown', (e)=>{ if(e.key === 'Enter'){ spinBtn.click(); } });

// Initialize simple static tracks for first view (so the reels look filled before spin)
(function initTracks(){
  for(let r=0;r<reels;r++){
    const track = document.getElementById('track'+r);
    // ensure it shows first symbols centered
    track.innerHTML = '';
    const context = 4;
    for(let i=-context;i<=context;i++){
      const idx = mod(i, symbols.length);
      const el = document.createElement('div');
      el.className = 'symbol';
      el.innerText = symbols[idx];
      track.appendChild(el);
    }
    // position so that center symbol is visible
    track.style.transform = `translateY(${-context*symbolHeight}px)`;
  }
})();
</script>
</body>
</html>